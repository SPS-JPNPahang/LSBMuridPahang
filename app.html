<!doctype html>
<html lang="ms">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>LAWATAN MURID SAMBIL BELAJAR</title>

  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-material-ui@5/material-ui.min.css">

  <style>
    .sidebar { background:#1f2937; color:#fff; min-height:100vh; }
    .sidebar a { color: #cbd5e1; }
    .sidebar .active { background:#0f172a; color:#fff; }
    .tab-active { background:#2563eb !important; color:#fff !important; }
    #filesModal { z-index: 60; }
    table { table-layout: auto; width: 100%; }
    td { vertical-align: top; }

    .download-card {
      border-radius: 0.75rem;
      border: 1px solid #e6e6e6;
      background: #fff;
      padding: 1rem;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      transition: box-shadow .18s ease, transform .08s ease;
    }
    .download-card:hover { box-shadow: 0 10px 25px rgba(16,24,40,0.08); transform: translateY(-3px); }
    .download-title { font-weight: 600; font-size: 1rem; color: #111827; }
    .download-desc { color: #4b5563; font-size: .92rem; line-height:1.35; margin-top:.5rem; }
    .download-actions { margin-top: .75rem; }
    .download-btn { display:inline-flex; align-items:center; justify-content:center; gap: .5rem; cursor:pointer; }
    .download-btn-primary { background:#2563eb; color:#fff; padding:.6rem .9rem; border-radius:0.5rem; font-weight:600; }
    .download-btn-secondary { background:#f3f4f6; color:#111827; padding:.56rem .85rem; border-radius:0.5rem; font-weight:600; border:1px solid #e5e7eb; }

    input[type="file"]::file-selector-button {
      margin-right: .5rem;
      padding: .35rem .6rem;
      border-radius: .35rem;
      border: 1px solid #d1d5db;
      background: #fff;
      cursor: pointer;
    }
    /* Status Card Animations */
#statusSection .border-l-4 {
  transition: all 0.3s ease;
}

#statusSection .border-l-4:hover {
  transform: translateX(4px);
}

#statusSchoolCode:focus {
  outline: none;
}

/* Pulse animation for new applications */
@keyframes statusPulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.8; }
}

.status-new-badge {
  animation: statusPulse 2s ease-in-out infinite;
}
    @media (min-width: 1280px) {
      .xl-cards-gap { gap: 1.25rem; }
    }

    @keyframes gentlePulseCycle {
      0%    { opacity: 1; transform: translateY(0); }
      7.14% { opacity: 0.7; }
      14.28%{ opacity: 1; }
      21.42%{ opacity: 0.7; }
      28.56%{ opacity: 1; }
      35.70%{ opacity: 0.7; }
      42.84%{ opacity: 1; }
      50.00%{ opacity: 0.7; }
      57.14%{ opacity: 1; }
      64.28%{ opacity: 0.7; }
      71.42%{ opacity: 1; }
      100%  { opacity: 1; }
    }

    .animate-gentle-pulse {
      animation: gentlePulseCycle 7s ease-in-out infinite;
    }

    .btn-access-granted {
      background-color: #16a34a;
      color: white;
      border: none;
    }

    .btn-logout {
      display: inline-flex;
      align-items: center;
      padding: 0.5rem 1rem;
      font-size: 0.875rem;
      font-weight: 500;
      background-color: #dc2626;
      color: white;
      border-radius: 0.375rem;
      border: none;
      cursor: pointer;
      transition: background-color 0.2s ease;
    }

    .btn-logout:hover {
      background-color: #b91c1c;
    }

    .hidden-inline {
      display: none !important;
    }

    @keyframes statusPulseGreen {
      0%, 100% {
        opacity: 1;
        transform: scale(1);
      }
      50% {
        opacity: 0.7;
        transform: scale(1.02);
      }
    }

    .status-pulse {
      animation: statusPulseGreen 2.5s ease-in-out infinite;
      color: #16a34a;
      font-weight: 600;
      text-shadow: 0 0 8px rgba(22, 163, 74, 0.3);
    }

    .nav-tab {
      display: block;
      padding: 0.75rem 1rem;
      margin-bottom: 0.25rem;
      border-radius: 0.375rem;
      transition: all 0.15s ease;
      cursor: pointer;
      text-decoration: none;
      color: #cbd5e1;
      font-size: 0.9rem;
      font-weight: 500;
    }

    .nav-tab:hover {
      background: rgba(255,255,255,0.05);
      color: #fff;
    }

    .nav-tab.active-tab {
      background: #2563eb;
      color: #fff;
      font-weight: 600;
      box-shadow: 0 2px 8px rgba(37,99,235,0.3);
    }

    .section-title {
      font-size: 1.5rem;
      font-weight: 700;
      color: #111827;
      margin-bottom: 1rem;
    }

    @media (max-width: 768px) {
      .nav-tab {
        padding: 0.65rem 0.9rem;
        font-size: 0.85rem;
      }
    }

    .status-new {
      background-color: #dbeafe;
      padding: 0.25rem 0.5rem;
      border-radius: 0.25rem;
      font-weight: 600;
      font-size: 0.75rem;
      color: #1e40af;
    }

    .status-query {
      background-color: #fef3c7;
      padding: 0.25rem 0.5rem;
      border-radius: 0.25rem;
      font-weight: 600;
      font-size: 0.75rem;
      color: #92400e;
    }

    .status-reviewed {
      background-color: #e0e7ff;
      padding: 0.25rem 0.5rem;
      border-radius: 0.25rem;
      font-weight: 600;
      font-size: 0.75rem;
      color: #3730a3;
    }

    .status-approved {
      background-color: #d1fae5;
      padding: 0.25rem 0.5rem;
      border-radius: 0.25rem;
      font-weight: 600;
      font-size: 0.75rem;
      color: #065f46;
    }

    .tooltip-icon {
      display: inline-block;
      margin-left: 4px;
      cursor: help;
      color: #2563eb;
      font-size: 0.9em;
    }
    
    td .view-files,
    td .btn-query,
    td .btn-preapprove {
      display: block;          /* satu baris satu butang */
      width: 90px;             /* SEMUA sama lebar */
      margin: 6px auto;        /* jarak menegak + center */
      text-align: center;
      font-weight: 600;
    }
      /* ===== SWEETALERT LOGIN SKIN (JPN STYLE) ===== */
      .swal-jpn-popup {
        border-radius: 14px;
        border: 2px solid #1e3a8a;      /* Biru gelap */
        padding: 1.25rem 1.25rem 1.4rem;
      }

      .swal-jpn-title {
        text-align: center;
        font-size: 1.15rem;
        font-weight: 700;
        color: #0f172a;
        margin-bottom: .5rem;
      }

      .swal-jpn-input {
        border-radius: 10px !important;
        border: 1.5px solid #c7d2fe !important;
        padding: .6rem .7rem !important;
        text-align: center;              /* Center input/select */
      }

      .swal-jpn-input:focus {
        border-color: #2563eb !important;
        box-shadow: 0 0 0 2px rgba(37,99,235,.15) !important;
      }

      .swal-jpn-confirm {
        border-radius: 10px !important;
        background: #1e3a8a !important;  /* Biru gelap */
        font-weight: 600 !important;
      }

      .swal-jpn-cancel {
        border-radius: 10px !important;
        font-weight: 600 !important;
      }

  </style>
</head>

  <body class="bg-gray-100 text-gray-800">

  <div id="loadingModal" class="hidden fixed inset-0 bg-black bg-opacity-60 z-50 items-center justify-center">
    <div class="bg-white p-6 rounded-lg shadow-xl flex flex-col items-center gap-4">
      <div class="animate-spin rounded-full h-12 w-12 border-b-4 border-blue-600"></div>
      <p class="text-lg font-semibold text-gray-700">Sila tunggu...</p>
    </div>
  </div>

  <div class="flex flex-col md:flex-row min-h-screen">
    <!-- SIDEBAR -->
    <aside class="sidebar w-full md:w-64 p-4 space-y-1">
      <div class="mb-6 flex items-center justify-between md:justify-start">
        <h2 class="text-xl font-bold">LSBM Portal</h2>
        <button id="mobileMenuBtn" class="md:hidden text-white">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
          </svg>
        </button>
      </div>

      <nav id="desktopMenu" class="hidden md:block space-y-1">
        <a href="#" id="tabInt" class="nav-tab active-tab">üè† Utama</a>
        <a href="#" id="tabPermohonan" class="nav-tab">üìù Permohonan</a>
        <a href="#" id="tabStatus" class="nav-tab">üîç Semak Status</a>
        <a href="#" id="tabDownloads" class="nav-tab">üì• Muat Turun</a>
        <a href="#" id="tabQueryRespond" class="nav-tab">üí¨ Query</a>
        <a href="#" id="tabLogin" class="nav-tab">üîê Login</a>
      </nav>


      <div id="mobileMenu" class="hidden md:hidden mt-4 space-y-1">
        <button id="closeMobileMenu" class="w-full text-right text-white mb-2">‚úï Tutup</button>

        <a href="#" id="tabInt" class="nav-tab">üè† Utama</a>
        <a href="#" id="tabPermohonan" class="nav-tab">üìù Permohonan</a>
        <a href="#" id="tabStatus" class="nav-tab">üîç Semak Status</a>
        <a href="#" id="tabDownloads" class="nav-tab">üì• Muat Turun</a>
        <a href="#" id="tabQueryRespond" class="nav-tab">üí¨ Query</a>
        <a href="#" id="tabLogin" class="nav-tab">üîê Login</a>
      </div>

    </aside>

    <!-- MAIN CONTENT -->
    <main class="flex-1 p-4 md:p-6">
  <!-- INTRO SECTION -->
      <section id="introSection" class="bg-white p-6 rounded shadow">
        <h1 class="section-title">Selamat Datang ke Portal LAWATAN MURID SAMBIL BELAJAR</h1>
        <p class="mb-4">Sistem permohonan lawatan murid sambil belajar untuk sekolah-sekolah di bawah JPN Pahang.</p>
        
        <div class="grid md:grid-cols-2 gap-4 mt-6">
          <div class="border-l-4 border-blue-500 pl-4">
            <h3 class="font-bold text-lg mb-2">üìù Untuk Sekolah</h3>
            <p class="text-sm text-gray-600">Gunakan borang permohonan untuk menghantar permohonan lawatan. Pastikan semua dokumen diperlukan dilampirkan.</p>
          </div>
          
          <div class="border-l-4 border-green-500 pl-4">
            <h3 class="font-bold text-lg mb-2">üëî Untuk Pegawai</h3>
            <p class="text-sm text-gray-600">Login untuk menyemak permohonan, menghantar query, atau meluluskan permohonan.</p>
          </div>
          
          <div class="border-l-4 border-purple-500 pl-4">
            <h3 class="font-bold text-lg mb-2">üè¢ Untuk PPD</h3>
            <p class="text-sm text-gray-600">Login PPD untuk melihat permohonan dari sekolah-sekolah di daerah anda.</p>
          </div>
          
          <div class="border-l-4 border-yellow-500 pl-4">
            <h3 class="font-bold text-lg mb-2">üîç Semak Status</h3>
            <p class="text-sm text-gray-600">Gunakan nombor rujukan dan email sekolah untuk menyemak status permohonan anda.</p>
          </div>
        </div>

        <div class="mt-8 p-4 bg-blue-50 rounded border border-blue-200">
          <h3 class="font-bold text-blue-900 mb-2">‚ÑπÔ∏è Maklumat Penting</h3>
          <ul class="list-disc list-inside text-sm text-blue-800 space-y-1">
            <li>Permohonan mesti dibuat sekurang-kurangnya 30 hari sebelum tarikh lawatan</li>
            <li>Lawatan maksimum 4 hari</li>
            <li>Semua fail mesti dalam format PDF (maksimum 10MB)</li>
            <li>Pastikan maklumat yang diisi adalah tepat dan lengkap</li>
          </ul>
        </div>
      </section>

      <!-- PERMOHONAN SECTION -->
      <section id="permohonanSection" class="hidden bg-white p-6 rounded shadow">
        <h2 class="section-title">Borang Permohonan Lawatan Murid</h2>
        
        <form id="permohonanForm" class="space-y-6">
          <div class="grid md:grid-cols-2 gap-4">
            <div>
              <label class="block font-semibold mb-1">Kod Sekolah <span class="text-red-500">*</span></label>
              <input id="schoolCode" type="text" required class="w-full border p-2 rounded" placeholder="Contoh: TCF0840">
            </div>
            
            <div>
              <label class="block font-semibold mb-1">Nama Sekolah <span class="text-red-500">*</span></label>
              <input id="schoolName" type="text" required class="w-full border p-2 rounded bg-gray-50 opacity-50 cursor-not-allowed" readonly>
            </div>
            
            <div>
              <label class="block font-semibold mb-1">Daerah <span class="text-red-500">*</span></label>
              <input id="daerah" type="text" required class="w-full border p-2 rounded bg-gray-50 opacity-50 cursor-not-allowed" readonly>
            </div>
            
            <div>
              <label class="block font-semibold mb-1">Peringkat Sekolah</label>
              <input id="peringkat" type="text" class="w-full border p-2 rounded bg-gray-50 opacity-50 cursor-not-allowed" readonly>
            </div>
            
            <div>
              <label class="block font-semibold mb-1">Poskod Sekolah</label>
              <input id="poskod" type="text" class="w-full border p-2 rounded" placeholder="Contoh: 27000">
            </div>
            
            <div>
              <label class="block font-semibold mb-1">Email Sekolah <span class="text-red-500">*</span></label>
              <input id="schoolEmail" type="email" required class="w-full border p-2 rounded" placeholder="sekolah@example.com">
            </div>
            
            <div>
              <label class="block font-semibold mb-1">Tarikh Mula Lawatan <span class="text-red-500">*</span></label>
              <input id="travelStart" type="date" required class="w-full border p-2 rounded">
            </div>
            
            <div>
              <label class="block font-semibold mb-1">Tarikh Tamat Lawatan <span class="text-red-500">*</span></label>
              <input id="travelEnd" type="date" required class="w-full border p-2 rounded">
            </div>
            
            <div>
              <label class="block font-semibold mb-1">Bilangan Kenderaan</label>
              <input id="vehicleCount" type="number" min="0" class="w-full border p-2 rounded" placeholder="0">
            </div>
            
            <div>
              <label class="block font-semibold mb-1">Bilangan Peserta</label>
              <input id="participantCount" type="number" min="0" class="w-full border p-2 rounded" placeholder="0">
            </div>
            
            <div>
              <label class="block font-semibold mb-1">Bilangan Pelajar</label>
              <input id="bp" type="number" min="0" class="w-full border p-2 rounded" placeholder="0">
            </div>
            
            <div>
              <label class="block font-semibold mb-1">Bilangan Guru/Pengiring</label>
              <input id="bm" type="number" min="0" class="w-full border p-2 rounded" placeholder="0">
            </div>
          </div>
          
          <div>
            <label class="block font-semibold mb-1">Tempat yang Dilawati</label>
            <textarea id="placeVisit" rows="2" class="w-full border p-2 rounded" placeholder="Nyatakan tempat yang akan dilawati"></textarea>
          </div>
                    
            <div class="border-t pt-4">
            <h3 class="font-bold text-lg mb-3">Maklumat Ketua Rombongan</h3>
            <div class="grid md:grid-cols-2 gap-4">
              <div>
                <label class="block font-semibold mb-1">Nama Ketua <span class="text-red-500">*</span></label>
                <input id="leaderName" type="text" required class="w-full border p-2 rounded" placeholder="Nama penuh ketua">
              </div>
              <div>
                <label class="block font-semibold mb-1">No. Telefon Ketua <span class="text-red-500">*</span></label>
                <input id="leaderPhone" type="tel" required class="w-full border p-2 rounded" placeholder="0123456789">
              </div>
            </div>
          </div>
          
          <div class="border-t pt-4">
            <h3 class="font-bold text-lg mb-3">Muat Naik Dokumen (PDF sahaja, max 10MB setiap fail)</h3>
            
            <div class="grid md:grid-cols-2 gap-4">
              <div>
                <label class="block font-semibold mb-1">
                  Kertas Kerja/Cadangan <span class="text-red-500">*</span>
                  <span class="tooltip-icon" onclick="showTooltip('INFO AKAN DIUPDATE')">‚ÑπÔ∏è</span>
                </label>
                <input id="file_kertasKerja" type="file" accept="application/pdf" required class="w-full border p-2 rounded">
              </div>
              
              <div>
                <label class="block font-semibold mb-1">Lampiran A <span class="text-red-500">*</span></label>
                <input id="file_maklumatAnggota" type="file" accept="application/pdf" required class="w-full border p-2 rounded">
              </div>
              
              <div>
                <label class="block font-semibold mb-1">
                  Permit/Lesen Kenderaan <span class="text-red-500">*</span>
                  <span class="tooltip-icon" onclick="showTooltip('INFO AKAN DIUPDATE')">‚ÑπÔ∏è</span>
                </label>
                <input id="file_permitBas" type="file" accept="application/pdf" required class="w-full border p-2 rounded">
              </div>
              
              <div>
                <label class="block font-semibold mb-1">
                  Lesen Memandu & Vokasional <span class="text-red-500">*</span>
                  <span class="tooltip-icon" onclick="showTooltip('INFO AKAN DIUPDATE')">‚ÑπÔ∏è</span>
                </label>
                <input id="file_lesenPemandu" type="file" accept="application/pdf" required class="w-full border p-2 rounded">
              </div>
              
              <div>
                <label class="block font-semibold mb-1">Intipati Taklimat Keselamatan <span class="text-red-500">*</span></label>
                <input id="file_taklimat" type="file" accept="application/pdf" required class="w-full border p-2 rounded">
              </div>
            </div>
          </div>
          
          <div class="flex justify-end gap-3 pt-4">
            <button type="reset" class="px-6 py-2 border rounded hover:bg-gray-100">Reset</button>
            <button id="submitBtn" type="submit" class="px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">Hantar Permohonan</button>
          </div>
        </form>
      </section>

      <!-- QUERY RESPOND SECTION -->
      <section id="queryRespondSection" class="hidden bg-white p-6 rounded shadow">
        <h2 class="section-title">Respon Kepada Query Pegawai</h2>
        
        <div class="mb-4 p-4 bg-yellow-50 border border-yellow-200 rounded">
          <p class="text-sm text-yellow-800">
            <strong>‚ÑπÔ∏è Arahan:</strong> Jika pegawai menghantar query kepada permohonan anda, anda akan menerima email dengan Query ID. 
            Gunakan borang ini untuk menghantar fail yang dikemaskini.
          </p>
        </div>
        
        <div class="space-y-4 mb-6">
          <div class="mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded">
            <p class="text-sm text-yellow-800">Masukkan <strong>salah satu</strong> sahaja - Query ID ATAU Kod Sekolah</p>
          </div>
          
          <div>
            <label class="block font-semibold mb-1">Query ID</label>
            <input id="respQueryId" type="text" class="w-full border p-2 rounded" placeholder="Contoh: Q-2025-001">
          </div>
          
          <div id="queryOfficerNoteBox"
              class="hidden mt-4 p-4 bg-yellow-50 border border-yellow-300 rounded">
            <h4 class="font-bold text-yellow-900 mb-2">üìå Catatan Pegawai</h4>
            <p id="queryOfficerNoteText"
              class="text-sm text-yellow-800 whitespace-pre-line"></p>
          </div>

        </div>
        
        <div class="border-t pt-4">
          <h3 class="font-bold text-lg mb-3">Muat Naik Fail Kemaskini (PDF sahaja, max 10MB)</h3>
          <p class="text-sm text-gray-600 mb-4">Pilih fail yang ingin dikemaskini. Anda tidak perlu muat naik semua fail, hanya yang diperlukan sahaja.</p>
          
          <div class="grid md:grid-cols-2 gap-4">
            <div>
              <label class="block font-semibold mb-1">Kertas Kerja/Cadangan</label>
              <input id="resp_file_kertasKerja" type="file" accept="application/pdf" class="w-full border p-2 rounded">
            </div>
            
            <div>
              <label class="block font-semibold mb-1">Lampiran A</label>
              <input id="resp_file_maklumatAnggota" type="file" accept="application/pdf" class="w-full border p-2 rounded">
            </div>
            
            <div>
              <label class="block font-semibold mb-1">Permit/Lesen Kenderaan</label>
              <input id="resp_file_permitBas" type="file" accept="application/pdf" class="w-full border p-2 rounded">
            </div>
            
            <div>
              <label class="block font-semibold mb-1">Lesen Memandu & Vokasional</label>
              <input id="resp_file_lesenPemandu" type="file" accept="application/pdf" class="w-full border p-2 rounded">
            </div>
            
            <div>
              <label class="block font-semibold mb-1">Intipati Taklimat Keselamatan</label>
              <input id="resp_file_taklimat" type="file" accept="application/pdf" class="w-full border p-2 rounded">
            </div>
          </div>
        </div>
        
        <div class="flex justify-end mt-6">
          <button id="sendQueryResponseBtn" class="px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">Hantar Respon</button>
        </div>
      </section>

      <!-- LOGIN SECTION -->
      <section id="loginSection" class="hidden bg-white p-6 rounded shadow">
        <h2 class="section-title">Login Sistem</h2>
        
        <div class="max-w-md mx-auto">
          <div class="mb-6 p-4 bg-blue-50 border border-blue-200 rounded">
            <p class="text-sm text-blue-800">
              <strong>‚ÑπÔ∏è Maklumat:</strong> Gunakan kata laluan yang diberikan untuk akses sistem.
            </p>
          </div>
          
          <button id="loginBtn" class="w-full px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold">
            üîê KLIK UNTUK LOGIN
          </button>
          
          <div class="mt-6 text-center text-sm text-gray-600">
            <p>Pegawai / PPD / Timbalan Pengarah</p>
          </div>
        </div>
      </section>

      <!-- OFFICER SECTION -->
      <section id="officerSection" class="hidden bg-white p-6 rounded shadow">
        <div class="flex justify-between items-center mb-4">
          <h2 class="section-title mb-0">Panel Pegawai <span id="officerLoggedAs" class="text-sm"></span></h2>
          <div class="flex gap-2">
            <button id="logoutOfficer" class="btn-logout hidden-inline">üö™ Log Out</button>
            <button id="refreshOfficer" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700">üîÑ Refresh</button>
            <button id="loginOfficer" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">LOGIN Pegawai</button>
          </div>
        </div>
        
      <div class="mb-4 flex flex-wrap gap-3 items-center">
        <select id="filterCategory" class="border p-2 rounded">
          <option value="">Semua Kategori</option>
          <option value="Menengah">Menengah</option>
          <option value="Rendah">Rendah</option>
        </select>

        <select id="filterStatus" class="border p-2 rounded">
          <option value="">Semua Status</option>
          <option value="NEW">Baru</option>
          <option value="QUERY">Query</option>
          <option value="REVIEWED">Disemak</option>
          <option value="FINAL_APPROVED">Diluluskan</option>
        </select>

        <select id="filterYear" class="border p-2 rounded">
          <option value="">Semua Tahun</option>
        </select>

        <div class="flex-1"></div>

        <input id="searchBox"
              type="text"
              placeholder="Cari Kod / Nama Sekolah‚Ä¶"
              class="border p-2 rounded w-72">
      </div>

      <div class="space-y-4">

        <!-- PERMOHONAN BARU -->
        <div class="border rounded">
          <button
            type="button"
            data-target="tableNew"
            class="collapse-header w-full flex justify-between items-center bg-blue-50 px-4 py-3 font-semibold">
            <span>üìã Permohonan Baru (<span id="countNew">0</span>)</span>
            <span class="arrow">‚ñº</span>
          </button>
          <div id="tableNew" class="overflow-x-auto"></div>
        </div>

        <!-- PERMOHONAN QUERY -->
        <div class="border rounded">
          <button
            type="button"
            data-target="tableQuery"
            class="collapse-header w-full flex justify-between items-center bg-yellow-50 px-4 py-3 font-semibold">
            <span>üí¨ Permohonan Query (<span id="countQuery">0</span>)</span>
            <span class="arrow">‚ñ∂</span>
          </button>
          <div id="tableQuery" class="overflow-x-auto hidden"></div>
        </div>

        <!-- PERMOHONAN DILULUSKAN -->
        <div class="border rounded">
          <button
            type="button"
            data-target="tableApproved"
            class="collapse-header w-full flex justify-between items-center bg-green-50 px-4 py-3 font-semibold">
            <span>‚úÖ Permohonan Diluluskan (<span id="countApproved">0</span>)</span>
            <span class="arrow">‚ñ∂</span>
          </button>
          <div id="tableApproved" class="overflow-x-auto hidden"></div>
        </div>

      </div>

      </section>

      <!-- PPD SECTION -->
      <section id="ppdSection" class="hidden bg-white p-6 rounded shadow">
        <div class="flex justify-between items-center mb-4">
          <h2 class="section-title mb-0">Panel PPD <span id="ppdLoggedAs" class="text-sm"></span></h2>
          <div class="flex gap-2">
            <button id="logoutPPD" class="btn-logout hidden-inline">üö™ Log Out</button>
            <button id="refreshPPD" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700">üîÑ Refresh</button>
            <button id="loginPPD" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">LOGIN PPD</button>
          </div>
        </div>
        
        <div class="space-y-4">

          <div class="border rounded">
            <button type="button"
              class="w-full text-left font-bold text-lg p-3 bg-blue-50 flex justify-between items-center"
              onclick="toggleSection('ppdNew')">
              üìã Permohonan Baru
              <span>‚ñæ</span>
            </button>
            <div id="ppdNew" class="p-2">
              <div id="ppdNewTable" class="overflow-x-auto"></div>
            </div>
          </div>

          <div class="border rounded">
            <button type="button"
              class="w-full text-left font-bold text-lg p-3 bg-green-50 flex justify-between items-center"
              onclick="toggleSection('ppdReviewed')">
              ‚úÖ Permohonan Disemak / Diluluskan
              <span>‚ñ∏</span>
            </button>
            <div id="ppdReviewed" class="p-2 hidden">
              <div id="ppdReviewedTable" class="overflow-x-auto"></div>
            </div>
          </div>

        </div>

      </section>

      <!-- DEPUTY SECTION -->
      <section id="deputySection" class="hidden bg-white p-6 rounded shadow">
        <div class="flex justify-between items-center mb-4">
          <h2 class="section-title mb-0">Panel Timbalan Pengarah <span id="dpLoggedAs" class="text-sm"></span></h2>
          <div class="flex gap-2">
            <button id="bulkApproveBtn" class="hidden px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700">üì¶ Bulk Approve</button>
            <button id="logoutDP" class="hidden btn-logout">üö™ Log Out</button>
            <button id="loginDP" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">Log masuk Timbalan</button>
          </div>
        </div>
        
        <div>
          <h3 class="font-bold text-lg mb-2 bg-yellow-50 p-2 rounded">‚è≥ Menunggu Kelulusan</h3>
          <div id="dpRequestsTable" class="overflow-x-auto"></div>
        </div>
      </section>
  <!-- STATUS SECTION -->
      <section id="statusSection" class="hidden bg-white p-6 rounded shadow">
        <h2 class="section-title">Semak Status Permohonan</h2>
        
        <div class="mb-4 p-4 bg-blue-50 border border-blue-200 rounded">
          <p class="text-sm text-blue-800">
            <strong>‚ÑπÔ∏è Arahan:</strong> Masukkan Nombor Rujukan (Request ID) dan Kod Sekolah yang digunakan semasa menghantar permohonan untuk menyemak status terkini.
          </p>
        </div>
        
        <div class="space-y-4 max-w-2xl">
          <div class="mb-4 p-3 bg-blue-50 border border-blue-200 rounded">
            <p class="text-sm text-blue-800">Masukkan <strong>salah satu</strong> sahaja - Kod Sekolah ATAU Request ID</p>
          </div>
          
          <div>
            <label class="block font-semibold mb-1">
              Kod Sekolah / Request ID
            </label>
            <input
              id="statusInput"
              type="text"
              class="w-full border p-2 rounded"
              placeholder="Contoh: TCF0840 atau REQ-1765262147521"
            >
          </div>

          
          <button id="checkStatusBtn" class="px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">üîç Semak Status</button>
        </div>
        <div id="statusResult" class="mt-8 hidden"></div>

      </section>

      <!-- DOWNLOADS SECTION -->
      <section id="downloadsSection" class="hidden bg-white p-6 rounded shadow">
        <h2 class="section-title">Muat Turun Template</h2>
        
        <div class="mb-4 p-4 bg-green-50 border border-green-200 rounded">
          <p class="text-sm text-green-800">
            <strong>üí° Petua:</strong> Muat turun template di bawah untuk memudahkan penyediaan dokumen permohonan anda.
          </p>
        </div>
        
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6 xl-cards-gap">
            <div class="download-card">
              <div>
                <div class="download-title">üìÑ TEMPLATE SURAT</div>
                <div class="download-desc">Template surat permohonan kelulusan kutipan lawatan</div>
              </div>
              <div class="download-actions">
                <button id="downloadKK" class="download-btn download-btn-primary">Lihat Template</button>
              </div>
            </div>

            <div class="download-card">
              <div>
                <div class="download-title">üìù LAMPIRAN A</div>
                <div class="download-desc">LAMPIRAN A ‚Äì SPI Bil.9 Tahun 2023</div>
              </div>
              <div class="download-actions">
                <button id="downloadMA" class="download-btn download-btn-primary">Lihat Fail</button>
              </div>
            </div>

            <div class="download-card">
              <div>
                <div class="download-title">üìú SPI KPM 9/2023</div>
                <div class="download-desc">Garis Panduan Lawatan Murid</div>
              </div>
              <div class="download-actions">
                <button id="downloadIT" class="download-btn download-btn-primary">Lihat SPI</button>
              </div>
            </div>

            <div class="download-card">
              <div>
                <div class="download-title">üìú SPI KPM 3/2019</div>
                <div class="download-desc">SOP Penggunaan Kenderaan Sendiri</div>
              </div>
              <div class="download-actions">
                <button id="downloadAA" class="download-btn download-btn-primary">Lihat SPI</button>
              </div>
            </div>

            <div class="download-card">
              <div>
                <div class="download-title">üìú SPK 1/2021</div>
                <div class="download-desc">Lampiran 7 ‚Äì Kertas Cadangan</div>
              </div>
              <div class="download-actions">
                <button id="downloadBB" class="download-btn download-btn-primary">Lihat SPK</button>
              </div>
            </div>

            <div class="download-card">
              <div>
                <div class="download-title">üìã SENARAI SEMAK</div>
                <div class="download-desc">Senarai semak lawatan terkini (2025)</div>
              </div>
              <div class="download-actions">
                <button id="downloadCC" class="download-btn download-btn-primary">Lihat Fail</button>
              </div>
            </div>

          </div>


      </section>
    </main>
  </div>
    
  <!-- ========== JAVASCRIPT MODULES - MODULAR ARCHITECTURE ========== -->
  <script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>

  <!-- Load modular JS files in correct order -->
  <script src="js/config.js"></script>
  <script src="js/utils.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/forms.js"></script>
  <script src="js/officer.js"></script>
  <script src="js/ppd.js"></script>
  <script src="js/deputy.js"></script>
  <script src="js/status.js"></script>
  <script src="js/main.js"></script>
  
  </body>
  </html>
